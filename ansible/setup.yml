# TODO: Add user to vboxsf

#- name: 'Print all available facts'
#  ansible.builtin.debug:
#    var: ansible_facts

- name: 'Gather package facts'
  ansible.builtin.package_facts:
    manager: auto

#- name: 'Print package facts'
#  ansible.builtin.debug:
#    var: ansible_facts.packages

- name: 'Checking required package: Flatpak'
  ansible.builtin.assert:
    that:
      - ansible_facts.packages['flatpak'] is defined
    fail_msg: 'flatpak must be installed since a restart is required'
    success_msg: 'Flatpak is installed'

- name: 'Checking required package: psutil'
  ansible.builtin.assert:
    that:
      - ansible_facts.packages['psutil'] is defined
    fail_msg: 'psutil must be installed'
    success_msg: 'psutil is installed'

- name: 'Set real_username'
  set_fact:
      real_username: '{{ansible_facts["env"]["SUDO_USER"]}}'

- name: 'Set is_virtual'
  set_fact:
      is_virtual: ansible_virtualization_role == 'guest'