- name: 'Set real_username'
  set_fact:
      real_username: '{{ansible_facts["env"]["SUDO_USER"]}}'
  tags: ['set_fact']

- name: 'Set is_virtual'
  set_fact:
      is_virtual: ansible_virtualization_role == "guest" | bool
  tags: ['set_fact']

- name: 'Own facts'
  ansible.builtin.debug:
    msg:
    - 'real_username: "{{real_username}}"'
    - 'is_virtual: "{{is_virtual}}"'
  tags: ['debug']